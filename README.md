## SimpleFileSystem

Описание
---------

Реализовать файловую класс способный работать с файлом или блоком памяти как с файловой системой.
Работа с файлом или блоком памяти будет реализована на основе работы со Stream.

Конструктор: `SimpleFileSystem(Stream, Size)`

Методы
------

* CreateFile — создание файлов/директорий
* OpenDirectory — открытие директории
* CreateDirectory — создание директории
* Cleanup — удаление файла/пустой директории ?
* CloseFile — закрытие файлового дескриптора
* ReadFile — чтение куска файла указанной длины с указанным смещением
* WriteFile — запись данных в файл с указанным смещением
* FlushFileBuffers — очистка буферов (кэша) файла
* GetFileInformation — получение информации о размере, атрибутах, времени создания/последнего доступа/модификации файла/директории
* FindFiles — получение списка файлов/директорий в указанной директории
* SetFileAttributes — установка атрибутов файла/директории
* SetFileTime — установка времени создания/последнего доступа/модификации файла/директории
* DeleteFile — пометка файла на удаление (удаление проводится в Cleanup)
* DeleteDirectory — пометка директории на удаление (удаление проводится в Cleanup)
* MoveFile — перемещение/переименование файла/директории
* SetEndOfFile — установка размера файла (используется при создании пустого файла определенной длины)
* LockFile — блокировка файла в single-доступе
* UnlockFile — снятие блокировки
* GetDiskFreeSpace — получение информации о кол-ве доступного/общего/свободного места в ФС
* Unmount — размонтирование/отключение ФС

Структура ФС
------------
* Метка того что это SimpleFileSystem (3 байта) - SFS.
* Размер файловой системы (5 байт) - Максимальный размер ФС 256^5 = 1 099 511 627 776 байта. ~ 1ТБ.
* Комментарий (1024 байта) - Комментарий к ФС.
* Блок выделенный для хранения папок (0,5% от размера ФС).
* Блок транзакций (1Мб).
* Остальное пространство для хранения файлов и их содержимого.

Структура блоков
----------------

| FolderNode             |
--------------------------
| NameSize (1 байт )     |
| Name (NameSize байт )  |
| Parent (url 5 байт )   |
| Beside (url 5 байт )   |
| FileFirst (url 5 байт )|

Описание:
* NameSize - Размер блока содержащего наименование.
* Name - Блока содержащий наименование.
* Parent - Ссылка на родительскую папку (00000 - в случае если папка в корне).
* Beside - Ссылка на следующую папку в той же родительской папке. (Элемент связного списка)
* FileFirst - Ссылка на файл (FileNode) находящийся в папке.


| FileNode                  |
-----------------------------
| Lock (1 байт)             |
| NameSize (1 байт)         |
| Name (NameSize байт)      |
| ModifyDate (12 байт)      |
| CreateDate (12 байт)      |
| Folder (url 5 байт)       |
| Beside (url 5 байт)       |
| ContentSize (5 байт)      |
| Content (? байт)          |

Описание:
* Lock - Признак блокировки файла
* NameSize - Размер блока содержащего наименование.
* Name - Блока содержащий наименование.
* ModifyDate - Время модификации файла в формете (ГГГГММДДЧЧММ) - (Год, Месяц, День, Час, Минута) 24 часовой формат
* CreateDate - Время модификации файла в формете (ГГГГММДДЧЧММ)
* Folder - Ссылка на папку содержащую файл
* Beside - Ссылка на следующий файл в той же папке. (Элемент связного списка)
* ContentSize - Размер содержимого файла
* Content - Содержимое файла

|  Content               |
--------------------------
| EndBlockAddr (5 байт)  |
| NextBlockAddr (5 байт) |
| Block (? байт)         |

Описание:
* EndBlockAddr - Адрес окончания блока
* NextBlockAddr - Адрес следующего блока
* Block - Содержимое блока
 

Транзакции
----------
Выделеный блок для транзакций необходим для коректировки неудачных операций записи в ФС.
> Необходимо составить список возможных операций записи в ФС, и описать структуру блоков содержащих информацию для откатки изменений.

Механизм:

1. Перед операцией какой либо записи в ФС производится запись в таблицу транзакции, с описание что будет сделано, с указанием полной информации для возможности откатить действия.
2. Произведение операций
3. Удаление записи из таблици транзакций

